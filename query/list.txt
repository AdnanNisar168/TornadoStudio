//////////////////////////////////////////// Calling Method In Controller //////////////////////////////////////////////////////////

[HttpPost]
        public ActionResult  List(string sortColumn, string sortOrder, int pageLength, int pageNumber, string SearchCode, string SearchName)

        {
            var datatablesNetList = new DataTablesNetList<GenderViewModel>();
            var totalRecords = 0;

            try
            { 

                var spParams = new DynamicParameters();
                spParams.Add("@CompanyID", CurrentCompanyID);
                spParams.Add("@SearchCode", SearchCode);
                spParams.Add("@SearchName", SearchName);
                spParams.Add("@sortColumn", sortColumn);
                spParams.Add("@sortOrder", sortOrder);
                spParams.Add("@pageNumber", pageNumber);
                spParams.Add("@recordsPerPage", pageLength);
                spParams.Add("@TotalRecords", dbType: DbType.Int32, direction: ParameterDirection.Output);


                var model = DapperQuery.GetListBySP<GenderViewModel>(DapperQuery.StoredProcedures.spInvGenderGetByCompanyIDSortingPaging, spParams);
                totalRecords = spParams.Get<int?>("@TotalRecords").GetValueOrDefault();

                datatablesNetList.data = model;

                datatablesNetList.recordsTotal = totalRecords;
                datatablesNetList.recordsFiltered = totalRecords;
            }
            catch (Exception ex)
            {
                log.Error(ex);
            }

            return Content(Newtonsoft.Json.JsonConvert.SerializeObject(datatablesNetList), "application/json");
        }
        //




//////////////////////////////////////////// Dapper Method //////////////////////////////////////////////////////////

public static List<T> GetListBySP<T>(StoredProcedures storedProcedure, DynamicParameters spParams)
        {
            return GetListBySP<T>(storedProcedure, spParams, 1 * 60);
        }

// method called in upper query

public static List<T> GetListBySP<T>(StoredProcedures storedProcedure, DynamicParameters spParams, int timeout)
        {
            var result = new List<T>();

            try
            {
                using (var cn = new SqlConnection(Common.ConnectionString))
                {
                    result = cn.Query<T>(Enum.GetName(typeof(StoredProcedures), storedProcedure), spParams, commandType: CommandType.StoredProcedure, commandTimeout: timeout).ToList();
                }
            }
            catch (Exception ex)
            {
                var paramString = " Parameters=" + string.Join(", ", from pn in spParams.ParameterNames select string.Format("@{0}={1}", pn, (spParams as SqlMapper.IParameterLookup)[pn]));
                var ex1 = new Exception(storedProcedure.ToString() + paramString, ex);
                log.Error(ex1);
                throw ex;
            }

            return result;
        }


public enum StoredProcedures
        {
            spAccountingChartOfAccountGetIndentedByCompanyID,
            spAccountingChartOfAccountGetByChartOfAccountKey,
            spAccountingChartOfAccountGetForSelect3,
            spAccountingGLNoteGetByCompanyIDGLNoteID,
            spAccountingAutoVoucherSettingGetAll,
            spAccountingBudgetGetByComapnyIDBudgetID,
            spAccountingVoucherGetByCompanyIDSortingPaging,
            spAccountingVoucherGetByCompanyIDVoucherID,
            spAccountingCostCenterGetByCompanyIDSortingPaging,
            spAccountingCostCenterGetByCostCenterID,
            spAccountingSubCostCenterGetByCompanyIDSortingPaging,
            spAccountingFinancialYearGetByCompanyIDSortingPaging,
            spAccountingFinancialYearGetByFinancialYearID,

            spCommonSessionGetCurrent,
            spBaseBrandGetByBrandIDSortingPaging,
            spBaseBrandGetByBrandID,
            spBaseCompanyPaymentGetOverduePayments,
            spBaseCompanySetupForCrystal,
            spBaseCompanyChangeCompanyID,
            spBaseCompanyDeleteAllData,
            spBaseCompanyDeleteAllDataByCompanyKey,
            spBaseCompanyGetBySortingPaging,
            spBaseCompanyGetTopActiveCompanies,
            spBaseCompanyPaymentGetByYear,
            spBaseCompanyPaymentAssert,
            spBaseCompanyTypicalSettingForShop,
            spBaseCompanyGetByCompanyKey,
            spBaseMenuGetAllowedByCoIDApplicationIDParentMenuIDUserID,
            spBaseReportGetActiveByParentIDUserAutoID,
            spBaseReportGetAllowedByUserAutoID,
            spBaseSettingGetByCompany,
            spGetCompanySettingsByCompnayKeyUserKey,
            spBaseReportGetAllowedByParentReportIDRoleAutoID,

            spCommonDashboardGetAllowedByUserAutoID,
            spCommonGroupGetByCompanyIDSortingPaging,
            spCommonJobGetPending,
            spCommonJobInsertVerifyStock,
            spCommonJobGenerateForDocumentUpdate,
            spCommonJobRecalculateStock,
            spCommonJobRecalculateStockForCurrentMonth,
            spCommonPartyShopAssociationWithStatus,
            spCommonPartyGetByCompanyIDPartyKey,
            spCommonRecordStatusGetAllowedByMenuIDUserAutoID,
            spCompanyProfileGetByCompanyIDCompanyProfileID,
            spCompanyProfileGetByCompanyIDSortingPaging,
            spCommonGroupGetByCompanyIDGroupID,
            spDashboardInvWarehouseSale,
            spDashboardCategoryPurchaseToProfit,
            spDashboardShopSale,
            spDashboardCategoryStock,
            spDashboardFinanceHeadClosing,
            spPartyGetByCompanyIDSortingPaging,
            spHREmployeeShopAssociationWithStatus,
            spHrEmployeeGetByEmployeeID,
            spHRDepartmentGetByCompanyIDSortingPaging,
            spHRSalaryHeadGetByCompanyIDSortingPaging,
            spHrSalaryHeadGetBySalaryHeadD,
            spLogGetByCompanyIDSortingPaging,
            spShopGetByCompanyIDShopID,
            spMessagingSmsGetByCompanyIDSortingPaging,
            spNewNumberByCompanyIDFormat,
            spPartyGetClosingBalance,
            // HR
            spHrDepartmentGetByDeparmentID,
            spHREmployeeGetByCompanyIDSortingPaging,

            // Inventory
            spInvBatchGetByCompanyIDSortingPaging,
            spInvBatchGetByBatchID,
            spInvBrandGetByCompanyIDSortingPaging,
            spInvBrandGetByBrandID,
            spInvColorGetByCompanyIDSortingPaging,
            spInvColorGetByColorID,
            spInvDeliveryChallanGetPending,
            spAccountingBudgetGetByCompanyIDSortingPaging,
            spInvDeliveryChallanGetByCompanyIDSortingPaging,
            spInvDeliveryChallanGetByCompanyIDDeliveryChallanID,
            spInvDeliveryChallanUpdateSaleQty,
            spInvDesignGetByCompanyIDSortingPaging,
            spInvDesignGetByDesignID,
            spInvGoodsReceiptNoteGetByCompanyIDGoodsReceiptNoteID,
            spInvGoodsReceiptNoteGetByCompanyIDSortingPaging,
            spInvGrnReturnGetByCompanyIDSortingPaging,
            spInvGrnReturnGetByCompanyIDGrnReturnID,
            spInvGenderGetByCompanyIDSortingPaging,
            spInvGenderGetByGenderID,
            spInvItemGetByCompanyIDItemVariationKey,
            spInvItemSummaryUpdateByItemVariationKeys,
            spInvItemGetByCompanyIDSortingPaging,
            spInvItemGetForItemRate,
            spInvItemCategoryGetByCompanyIDSortingPaging,
            spInvItemCategoryGetByCompanyIDItemCategoryID,
            spInvItemGetReorderForPurchaseOrder,
            spInvItemDeleteByCompanyIDItemTypeID,
            spInvItemNewCodeGetByCompanyIDItemCategoryKey,
            spInvItemSummaryByItemVariations,
            spInvItemSummaryByItemVariations2,
            spInvItemForDropdown,
            spInvItemListFullDetail,
            spInvItemGetByCompanyIDItemKey,
            spInvItemSummaryRecalculate,
            spInvItemStockUpdate,
            spInvItemVariationUpdateItemFullCodeFormatted,
            spInvItemVariationLevelGetByWarehouseID,
            spInvIGPGetbyCompanyIDSortingPaging,
            spInvRawMaterialGetForItemRate,
            spInvManufacturerPartyAssociationGetAssigned,
            spInvManufacturerGetByManufacturerID,
            spInvOgpGetByCompanyIDSortingPaging,
            spInvIGPGetByCompanyIDIGPKey,
            spInvOGPGetByCompanyIDOGPKey,
            spInvProductGroupGetByCompanyIDSortingPaging,
            spInvPurchaseOrderGetByCompanyIDSortingPaging,
            spInvProductGroupGetByProductGroupID,
            spInvProductLineGetByProductLineID,
            spInvReceiveProductionGetByCompanyIDSortingPaging,
            spInvReceiveProductionGetByCompanyIDReceiveProductionID,
            spInvRepairingInvoiceGetByCompanyIDSortingPaging,
            spInvRepairingInvoiceGetByInvoiceKey,
            spInvSaleGetByCompanyIDSaleID,
            spInvSaleGetByCompanyIDSortingPaging,
            spInvSaleReturnGetByCompanyIDSaleReturnID,
            spInvSaleReturnGetByCompanyIDSortingPaging,
            spInvSizeGetByCompanyIDSortingPaging,
            spInvSinReturnGetByCompanyIDSortingPaging,
            spInvSizeGetByCompanyIDOrderBySizeCode,
            spInvStoreIssueNoteReturnGetByCompanyIDStoreIssueNoteID,
            spInvStoreIssueNoteGetByCompanyIDSortingPaging,
            spInvStockAdjustmentGetByCompanyIDStockAdjustmentID,
            spInvStockAdjustmentGetByCompanyIDSortingPaging,
            spInvStoreGetByStoreID,
            spInvStyleGetByCompanyIDSortingPaging,
            spInvStoreGetByCompanyIDSortingPaging,
            spInvTransferStockDetailByMinimumStockLevel,
            spInvTempInvoiceGetByCompanyIDSortingPaging,
            spInvTempInvoiceGetByCompanyIDTempInvoiceKey,
            spInventoryItemWithoutSizesForDropdown,
            spInventoryWarehouseGetByCompanyIDSortingPaging,
            spInventoryOgpGetByCompanyIDSortingPaging,
            spInventoryShopGetByCompanyIDSortingPaging,
            spInventorySaleOrderGetByCompanyIDSortingPaging,
            spInvLotGetByCompanyIDSortingPaging,
            spInvLotGetByLotID,
            spInvSeasonGetByCompanyIDSortingPaging,
            spInvSeasonGetBySeasonID,
            spInvStyleGetByStyleID,

            spReportInvRepairigSaleSummary,
            spReportInvRepairigSaleItemized,
            spReportRepairingInvoice,
            spReportProdReceiveProductionListSizeWise,
            spReportPurchaseDetail,
            spReportInvPurchaseByItemCategory,
            spReportInvPurchaseByYear,
            spReportInvPurchaseByMonth,
            spReportInvTransferStockItemized,
            spReportInvTransferStockSummary,
            spReportSalesInvoiceCustomerBalance,
            spReportShopSaleDiscountsByMonth,
            spReportTempInvoice,
            spInvStoreIssueNoteGetByCompanyIDStoreIssueNoteID,
            spCommonJobGetListBySortingPaging,
            spReportInvSaleBySalesmanAndItem,

            //PMS
            spPmsTicketGetByCompanyIDSortingPaging,

            //Production
            spProdAssemblyGetByCompanyIDAssemblyKey,
            spProdAssemblyGetByCompanyIDSortingPaging,
            spProdConOrderGetByCompanyIDSortingPaging,
            spProdFormulaGetByCompanyIDFormulaID,
            spProdFormulaGetByCompanyIDSortingPaging,
            spProdProcessStockByCompanyIDOrderIDWorkflowID,
            spProdProcessWorkflowGetByCompanyIDWorkflowID,
            spProdProcessWorkFlowGetByCompanyID,
            spProdProcessStatusRecalculate,
            spProdProcessGetByProcessID,
            spProdOrderGetInCompleteByCompanyID,
            spProdOrderGetByCompanyIDOrderID,
            spProdOrderDetailGetForReceiveProductionByCompanyIDOrderID,
            spProdOrderGetRequiredRawMaterialsByCompanyIDItemVariationKey,
            spProdOrderGetRawMaterialsByOrderID,
            spProdProcessWorkflowGetByCompanyIDSortingPaging,
            spProdProcessGetByCompanyIDSortingPaging,
            spProdProcessProductionGetByCompanyIDSortingPaging,
            spProdProcessProductionByComapnyIDProcessProductionID,
            spReportProdProductionAssembly,
            spReportProdReceiveProductionList,
            spReportProdOrderIssuances,

            //Finance
            spFinanceAdjustmentGetByCompanyIDAdjustmentID,
            spFinanceAdjustmentGetByCompanyIDSortingPaging,
            spFinanceExpenseGetByCompanyIDSortingPaging,
            spFinanceHeadShopAssociationWithStatus,
            spFinanceHeadGetByCompanyIDSortingPaging,
            spFinanceReceiptGetByCompanyIDReceiptID,
            spFinanceReceiptGetByCompanyIDSortingPaging,
            spFinancePaymentGetByCompanyIDSortingPaging,
            spFinancePaymentGetByCompanyIDPaymentID,
            spFinanceHeadShopAssociationGetAll,

            //Base
            spBaseCompanyGetTableRowCount,

            // Messaging
            spMessagingAlertGetPending,
            spMessagingAlertGetByAlertKeySortingPaging,
            spMessagingAlertGetByAlertKey,

            //Report
            spReportBudget,            
            spReportCommonContacts,
            spReportCompanyStock,
            spReportCompanyOverview,
            spReportFinanceCustomerLedgerSummary,
            spReportFinanceCustomerRecoverySheet,
            spReportSaleSummaryByPartySizeWise,
            spReportSaleSummarySizeWise,
            spReportFinanceHeadLedger,            
            spReportFinanceHeadLedgerSummary,
            spReportGeneralLedger,
            spReportItemIncomeStatement,
            spReportInvDeadItems,
            spReportInvPendingDeliveryChallans,
            spReportInvPendingDeliveryChallansItemized,
            spReportInvInventoryActivity,
            spReportInvPurchasesSizeWise,
            spReportInvPurchaseReturnDetailSizeWise,
            spReportSaleSummaryDynamicGroup,
            spReportInvSaleByItem,
            spReportInvBardCode,
            spReportStock,
            spReportStock2,
            spReportInvSeasonStock,
            spReportInvStockByWarehouse,
            spReportStockRegister,
            spReportStockRegisterSize,
            spReportAccTrialBalance,
            spReportAccTrialBalance2,
            spReportAccountingMonthlySummary,
            spReportInvCategoryWiseStock,
            spReportInvDayEnd,
            spReportInvStockLevel,
            spReportInvOverStock,
            spReportInvShortStock,
            spReportInvStoreIssnueNoteGeneralList,
            spReportInvStoreIssnueNoteReceipeList,            
            spReportInvStockTransfersSizeWise,
            spReportInvSaleByPaymentMode,
            spReportInvSaleByItemCategoryWithProfit,
            spReportInvSaleByItemProductGroup,
            spReportInvRawMaterialStock,
            spReportInvSalesSizeWise,
            spReportInvSaleReturnsSizeWise,
            spReportInvProcessWiseIssuanceAndReturn,
            spReportInvPurchaseReturnsSizeWise,
            spReportInvPurchaseDetailSizeWise,
            spReportInvSalesAndReturnsSizeWise,
            spReportInvSaleItemized,
            spReportInvStockTransfersDetailSizeWise,
            spReportInvStockMovement,

            spReportFinanceReceiptsSummaryByPartyManager,
            spReportFinanceReceiptsMonthSummaryByCustomer,
            spReportFinancePaymentsSummaryByPartyManager,
            spReportFinanceHeadLedgerDetail,
            spReportFinanceReceiptsList,
            spReportYearBudget,
            spReportProdProcessStatusSizeWise,
            spReportSecUserActivity,
            spReportUnbalancedVouchers,
            spReportVouchersBalanceSummary,
           
            //Security
            spSecStatusAllowed,
            spSecRoleDashboardAssociationWithStatus,
            spSecRoleGetAssignedToMenu,
            spSecRoleGetByCompanyIDSortingPaging,
            spSecRoleGetByRoleID,
            spSecRoleMenuAssociationWithStatusGetbyCompanyIDRoleIDParentMenuID,
            spSecRoleMenuAssociationGetByRoleKey,
            spSecUserGetBySortingPaging,
            spSecUserGetByCompanyIDUserID,
            spSecUserGetShopUsersByCompanyIDSortingPaging,
            spStatusRoleAssociationGetStatus,
            spSecRoleCreateCopy,
            spWarehouseGetByCompanyIDWarehouseID,
            spSecUserGetLoginHistoryList,
            spSecUserGetActiveUserList,
            spSecUserGetLocked,

            // Account
            spReportAccChartOfAccountAging,
            spReportAccountingAccountsPayable,
            spReportFinanceHeadTypeMonthly,
            spReportFinancialActivity,
            spProdConOrderOutGetByCompanyIDSortingPaging,
            spInvProductLineGetByCompanyIDSortingPaging,
        }
